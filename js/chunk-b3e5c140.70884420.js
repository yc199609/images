(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b3e5c140"],{"392e":function(e,t,s){},"5c32":function(e,t,s){"use strict";var o=s("81f5"),i=s.n(o);i.a},"81f5":function(e,t,s){},"9ed6":function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"loginBox",staticClass:"login-container",attrs:{id:"contanier"}},[s("div",{ref:"mask",staticClass:"mask",attrs:{id:"mask"}},[e._m(0)]),s("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[s("el-card",{staticClass:"login-form"},[s("div",{ref:"bg",staticClass:"bg-banner"}),s("div",{staticClass:"system-login"},[s("div",{staticClass:"title-container"},[s("h3",{staticClass:"title"},[e._v(e._s(e.$t("login.login.title")))]),s("lang-select",{staticClass:"set-language"})],1),s("el-form-item",{attrs:{rules:[{required:!0,message:this.$t("login.login.cannotBeEmpty")}],prop:"organize"}},[s("el-input",{attrs:{disabled:!e.loginForm.isCanEditOrganize,maxlength:150,placeholder:e.$t("login.login.agnecyCode"),"prefix-icon":"el-icon-s-data",name:"organize",type:"text","auto-complete":"off"},model:{value:e.loginForm.organize,callback:function(t){e.$set(e.loginForm,"organize",t)},expression:"loginForm.organize"}})],1),s("el-form-item",{attrs:{rules:[{required:!0,message:this.$t("login.login.phoneNumberCannotBeEmpty")}],prop:"cellPhone"}},[s("el-input",{attrs:{maxlength:50,placeholder:e.$t("login.login.phoneNumber"),"prefix-icon":"el-icon-user",name:"cellPhone",type:"text","auto-complete":"new-password"},model:{value:e.loginForm.cellPhone,callback:function(t){e.$set(e.loginForm,"cellPhone",t)},expression:"loginForm.cellPhone"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{type:e.pwdType,maxlength:50,placeholder:e.$t("login.login.password"),"prefix-icon":"el-icon-lock",name:"password","auto-complete":"new-password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),s("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[s("i",{staticClass:"iconfont"},[e._v(e._s("password"===e.pwdType?"":""))])])],1),s("el-form-item",{staticStyle:{border:"0"}},[s("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,type:"primary",round:""},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v(e._s(e.$t("login.login.login")))])],1),s("div",{staticClass:"tips"},[s("span",{staticStyle:{"margin-right":"20px"}},[s("el-link",{on:{click:function(t){e.showDialogPassword=!0}}},[e._v(e._s(e.$t("login.login.forgetPassword")))])],1)])],1)])],1),s("el-dialog",{attrs:{title:e.$t("login.login.RetrievePassword"),visible:e.showDialogPassword,"modal-append-to-body":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialogPassword=t}}},[s("password",{on:{hidden:e.hiddenColse}})],1),s("el-dialog",{attrs:{visible:e.initView,"modal-append-to-body":!1,"close-on-click-modal":!1,title:"首次登录请重置密码"},on:{"update:visible":function(t){e.initView=t},close:e.initPasswordHidden}},[s("initPassword",{on:{submit:e.initPasswordSubmit}})],1)],1)},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"spinner"},[s("div",{staticClass:"rect1"}),s("div",{staticClass:"rect2"}),s("div",{staticClass:"rect3"}),s("div",{staticClass:"rect4"}),s("div",{staticClass:"rect5"})])}],n=(s("a481"),s("39e2")),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"all-container"},[s("div",{staticClass:"all-container-padding bg"},[s("el-form",{ref:"EditorUserForms",attrs:{model:e.userlist,rules:e.rules}},[s("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:e.$t("login.password.phoneNoumber"),prop:"phone"}},[s("el-col",{attrs:{span:8}},[s("el-input",{attrs:{maxlength:50,placeholder:e.$t("login.password.entePhoneNumber"),"auto-complete":"new-password"},on:{blur:e.imgCode},model:{value:e.userlist.phone,callback:function(t){e.$set(e.userlist,"phone",t)},expression:"userlist.phone"}})],1)],1),s("el-form-item",{staticStyle:{position:"relative"},attrs:{"label-width":e.formLabelWidth,label:e.$t("login.password.PictureVerificationCode"),prop:"pictrue"}},[s("el-col",{attrs:{span:8}},[s("el-input",{staticStyle:{float:"left"},attrs:{maxlength:50,placeholder:e.$t("login.password.enterPictureVerificationCode"),"auto-complete":"new-password"},model:{value:e.userlist.pictrue,callback:function(t){e.$set(e.userlist,"pictrue",t)},expression:"userlist.pictrue"}}),s("img",{ref:"imgcode",staticStyle:{position:"absolute",top:"0","margin-left":"10px",border:"0"},attrs:{src:"",alt:""}})],1)],1),s("el-form-item",{staticStyle:{position:"relative"},attrs:{"label-width":e.formLabelWidth,label:e.$t("login.password.SMSVerificationCode"),prop:"smsv"}},[s("el-col",{attrs:{span:8}},[s("el-input",{staticStyle:{float:"left"},attrs:{maxlength:50,placeholder:e.$t("login.password.enterSMSVerificationCode"),"auto-complete":"new-password"},model:{value:e.userlist.smsv,callback:function(t){e.$set(e.userlist,"smsv",t)},expression:"userlist.smsv"}}),s("el-button",{staticStyle:{position:"absolute",top:"0","margin-left":"10px",border:"0"},attrs:{type:e.sendSmsv?"primary":"info",plain:""},on:{click:e.SendForgetPsw}},[e._v(e._s(e.sendCode))])],1)],1),s("br"),s("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:e.$t("login.password.newPassword"),prop:"pass"}},[s("el-col",{attrs:{span:8}},[s("el-input",{attrs:{id:"newkey",maxlength:50,placeholder:e.$t("login.password.enterNewPassword"),"auto-complete":"new-password",type:"password"},model:{value:e.userlist.pass,callback:function(t){e.$set(e.userlist,"pass",t)},expression:"userlist.pass"}})],1)],1),s("el-form-item",{attrs:{maxlength:50,"label-width":e.formLabelWidth,label:e.$t("login.password.repeatNewPassword"),prop:"checknewpass"}},[s("el-col",{attrs:{span:8}},[s("el-input",{attrs:{maxlength:50,placeholder:e.$t("login.password.enterYourNewPasswordAgain"),"auto-complete":"new-password",type:"password"},model:{value:e.userlist.checknewpass,callback:function(t){e.$set(e.userlist,"checknewpass",t)},expression:"userlist.checknewpass"}})],1)],1)],1),s("div",{staticClass:"grid-content bg-purple"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.EditorUserClick()}}},[e._v(e._s(e.$t("common.save")))])],1)],1)])},a=[],l=(s("ac6a"),s("5df3"),s("7ded")),d={name:"Password",data:function(){var e=this,t=function(t,s,o){""===s?o(new Error(e.$t("login.password.enterPassword"))):s.length<6?o(new Error(e.$t("login.password.passwordCannotBeLessThan"))):o()},s=function(t,s,o){""===s?o(new Error(e.$t("login.password.enterYourNewPasswordAgain"))):s!==e.userlist.pass?o(new Error(e.$t("login.password.twoPasswordInconsistencies"))):o()};return{sendCode:this.$t("login.password.clickGetVerificationCode"),sendSmsv:!0,activeName:"first",loading:!0,userlist:{phone:"",smsv:"",pass:"",checknewpass:""},formLabelWidth:"200px",rules:{phone:[{required:!0,message:this.$t("login.password.entePhoneNumber")},{pattern:/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/,message:this.$t("login.password.phoneFormatError")}],pictrue:[{required:!0,message:this.$t("login.password.enterPictureVerificationCode")}],smsv:[{required:!0,message:this.$t("login.password.enterSMSVerificationCode")}],pass:[{validator:t,required:!0,trigger:"blur"}],checknewpass:[{validator:s,required:!0,trigger:"blur"}]}}},created:function(){},methods:{imgCode:function(){var e=this;this.$refs.EditorUserForms.validateField("phone",(function(t){t||e.$refs.imgcode.setAttribute("src","/api/User/GetImageCode?mobile="+e.userlist.phone+"&rander="+Math.random(1))}))},SendForgetPsw:function(){var e=this,t=this,s=t.userlist.phone,o=t.userlist.pictrue,i=new Promise((function(t){e.$refs.EditorUserForms.validateField("phone",(function(e){e||t()}))})),n=new Promise((function(t){e.$refs.EditorUserForms.validateField("pictrue",(function(e){e||t()}))}));Promise.all([i,n]).then((function(){if(t.sendSmsv){t.sendSmsv=!1;var i=60;t.sendCode=e.$t("login.password.RetrieveValidationCodeIn")+"("+i+e.$t("login.password.seconds")+")";var n=setInterval((function(){i--,i<=0?(t.sendCode=e.$t("login.password.RetrieveValidationCodeIn"),t.sendSmsv=!0,clearInterval(n)):t.sendCode=e.$t("login.password.RetrieveValidationCodeIn")+"("+i+e.$t("login.password.seconds")+")"}),1e3);Object(l["f"])(s,o).then((function(){})).catch((function(){clearInterval(n),t.sendSmsv=!0,t.sendCode=e.$t("login.password.RetrieveValidationCodeIn")}))}}))},EditorUserClick:function(){var e=this;e.$refs.EditorUserForms.validate((function(t){t&&Object(l["g"])({mobile:e.userlist.phone,sms:e.userlist.smsv,password:e.userlist.pass}).then((function(){e.$emit("hidden"),e.$message({message:"".concat(e.$t("login.password.successfulPassword")),type:"success"}),e.$refs.EditorUserForms.resetFields()})).catch((function(){}))}))}}},c=d,p=s("2877"),u=Object(p["a"])(c,r,a,!1,null,null,null),m=u.exports,g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"form",attrs:{model:e.from,rules:e.rules}},[s("el-form-item",{attrs:{prop:"newpassword",label:"新密码"}},[s("el-input",{attrs:{maxlength:150},model:{value:e.from.newpassword,callback:function(t){e.$set(e.from,"newpassword",t)},expression:"from.newpassword"}})],1),s("el-form-item",{attrs:{prop:"submitpassword",label:"确认密码"}},[s("el-input",{model:{value:e.from.submitpassword,callback:function(t){e.$set(e.from,"submitpassword",t)},expression:"from.submitpassword"}})],1),s("el-form-item",[[s("el-button",{on:{click:e.submit}},[e._v("确定")])]],2)],1)},w=[],f={name:"InitPassword",data:function(){var e=this,t=function(t,s,o){return s?s!==e.from.newpassword?o(new Error("2次密码输入不一致")):void o():o(new Error("请确认密码"))};return{from:{newpassword:"",submitpassword:""},rules:{newpassword:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"请输入6位以上密码",trigger:"blur"}],submitpassword:[{validator:t,trigger:"blur"}]}}},methods:{submit:function(){var e=this;this.$refs.form.validate((function(t){t&&Object(l["b"])(e.from.newpassword).then((function(){e.$emit("submit")}))}))}}},h=f,b=Object(p["a"])(h,g,w,!1,null,null,null),v=b.exports,$={name:"Login",components:{LangSelect:n["a"],password:m,initPassword:v},data:function(){var e=this,t=function(t,s,o){s.length<6&&o(new Error(e.$t("login.login.cannotBeLessThan6Digits"))),o()};return{loginForm:{organize:"",cellPhone:"",password:"",isCanEditOrganize:!0},loginRules:{password:[{required:!0,trigger:"blur",validator:t}]},loading:!1,pwdType:"password",showDialogPassword:!1,redirect:void 0,initView:!1,token:"",img:""}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},created:function(){var e=this;Object(l["c"])().then((function(t){e.img=t.data.config.DMSLoginImage,e.$refs.bg.style.backgroundImage="url(".concat(e.img,")"),e.$refs.loginBox.style.backgroundImage="url(".concat(t.data.config.dmsDefaultLoginBGImage,")")})),window.setTimeout((function(){e.$store.dispatch("GetInfo",e.loginForm).then((function(t){e.loginForm.organize=t.data.siteInfo.companyCode,e.loginForm.isCanEditOrganize=""===t.data.siteInfo.companyCode;var s=document.getElementById("contanier"),o=document.getElementById("mask");s.removeChild(o)}))}),1e3)},mounted:function(){this.$refs.mask.style.height=document.getElementById("app").clientHeight+"px"},methods:{hiddenColse:function(){this.showDialogPassword=!1},showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;e.loading=!0,Object(l["d"])(e.loginForm).then((function(t){t&&0===t.data.isNeedResetPassword?e.initView=!0:window.location.replace(t.data.redirectUrl)})).catch((function(){e.loading=!1}))}))},initPasswordSubmit:function(){this.initPasswordHidden(),this.$store.commit("SET_TOKEN",this.token),this.$router.push({path:this.redirect||"/"})},initPasswordHidden:function(){this.loading=!1,this.initView=!1}}},C=$,y=(s("5c32"),s("fb8d"),Object(p["a"])(C,o,i,!1,null,"26e3626b",null));t["default"]=y.exports},fb8d:function(e,t,s){"use strict";var o=s("392e"),i=s.n(o);i.a}}]);
//# sourceMappingURL=chunk-b3e5c140.70884420.js.map