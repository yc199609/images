(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57a38824"],{"105e":function(e,t,n){},"7e55":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("div",[i("el-tag",{attrs:{effect:"plain"}},[e._v("设备: "+e._s(e.code))]),i("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"mini",type:"success",icon:"el-icon-plus",plain:""},on:{click:e.add}},[e._v("新增")]),i("el-popover",{staticStyle:{"margin-left":"50px"},attrs:{placement:"bottom",width:"400",trigger:"click"}},[i("el-form",{attrs:{inline:!0}},[i("el-form-item",[i("el-select",{model:{value:e.template,callback:function(t){e.template=t},expression:"template"}},e._l(e.templateList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("批量添加")])],1)],1),i("el-button",{attrs:{slot:"reference",size:"mini",icon:"el-icon-circle-plus"},slot:"reference"},[e._v("引用指标模板")])],1)],1),i("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,border:""}},[i("template",{slot:"empty"},[i("div",{staticClass:"empty"},[i("img",{attrs:{src:n("a431")}}),i("p",[e._v("暂无数据")])])]),i("el-table-column",{attrs:{label:"代码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?i("el-select",{model:{value:t.row.cmdFieldId,callback:function(n){e.$set(t.row,"cmdFieldId",n)},expression:"scope.row.cmdFieldId"}},e._l(e.fieldList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.code,value:e.id}})})),1):i("div",[e._v("\n            "+e._s((e.fieldList.find((function(e){return e.id==t.row.cmdFieldId}))||{}).code)+"\n        ")])]}}])}),i("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?i("el-input",{model:{value:t.row.name,callback:function(n){e.$set(t.row,"name",n)},expression:"scope.row.name"}}):i("div",[e._v("\n            "+e._s(t.row.name)+"\n        ")])]}}])}),i("el-table-column",{attrs:{label:"描述",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?i("el-input",{model:{value:t.row.description,callback:function(n){e.$set(t.row,"description",n)},expression:"scope.row.description"}}):i("div",[e._v("\n            "+e._s(t.row.description)+"\n        ")])]}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(n){return e.edit(t.row)}}},[e._v(e._s(t.row.edit?"保存":e.$t("list.edit")))]),i("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.del(t)}}},[e._v(e._s(e.$t("list.delete")))])]}}])})],2),i("el-button",{on:{click:e.submit}},[e._v("确认修改")])],1)},a=[],r=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),c=n("9536"),o=n("b775"),l={GetAll:"/api/terminal/CmdField/GetAll",TemplateGetAll:"/api/terminal/SensorTemplate/GetAll",GetById:"/api/terminal/SensorTemplate/GetById"};function d(){return Object(o["a"])({url:l.GetAll,method:"get"})}function s(){return Object(o["a"])({url:l.TemplateGetAll,method:"get"})}function u(e){return Object(o["a"])({url:l.GetById,method:"get",params:{id:e}})}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={name:"PartDevice",data:function(){return{tableData:[],code:"",detailVisible:!1,addOtherVisible:!1,fieldList:[],templateList:[],template:void 0}},created:function(){this.init()},methods:{handleAdd:function(){var e=this;u(this.template).then((function(t){var n=t.data.items.map((function(t){return f({},t,{cmdFieldId:t.fieldId,description:"",deviceId:e.$route.query.id,id:0})}));e.$set(e,"tableData",e.tableData.concat(n))}))},submit:function(){var e=this;Object(c["a"])(this.tableData).then((function(){e.$message({type:"success",message:"修改成功",duration:500,onClose:function(){e.init()}})}))},edit:function(e){e.edit?this.$set(e,"edit",!1):this.$set(e,"edit",!0)},add:function(){var e=this.tableData;e.unshift({edit:!0,deviceId:this.$route.query.id,name:"",cmdFieldId:null,description:""}),this.$set(this,"tableData",e)},init:function(){var e=this;this.code=this.$route.query.code,s().then((function(t){e.$set(e,"templateList",t.data)})),Object(c["d"])({deviceId:this.$route.query.id}).then((function(t){e.tableData=t.data})),d().then((function(t){e.$set(e,"fieldList",t.data)}))},del:function(e){var t=this;this.$confirm("此操作将删除该项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$message({type:"success",message:"已删除"});var n=t.tableData;n.splice(e.$index,1),t.$set(t,"tableData",n)}))}}},b=m,v=(n("c630"),n("2877")),h=Object(v["a"])(b,i,a,!1,null,"306cc7d8",null);t["default"]=h.exports},9536:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"h",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return m}));var i=n("b775"),a={GetAll:"/api/dms/DevicePartType/GetAll",create:"/api/dms/DevicePartType/create",Delete:"/api/dms/DevicePartType/delete",UpdateInfo:"/api/dms/DevicePartType/UpdateInfo",GetList:"/api/dms/DevicePartType/GetList",GetById:"/api/dms/DevicePart/GetById",GetByDeviceId:"/api/dms/DevicePart/GetByDeviceId",UpdateInfoDevice:"/api/dms/DevicePart/UpdateInfo",createDevice:"/api/dms/DevicePart/create",deleteDevice:"/api/dms/DevicePart/delete",BatchAdd:"/api/dms/DevicePart/BatchAdd"};function r(){return Object(i["a"])({url:a.GetAll,method:"get"})}function c(e){return Object(i["a"])({url:a.create,method:"post",headers:{"Content-Type":"application/json"},data:e})}function o(e){return Object(i["a"])({url:a.Delete,method:"post",headers:{"Content-Type":"application/json"},data:e})}function l(e){return Object(i["a"])({url:a.GetList,method:"get",params:e})}function d(e){return Object(i["a"])({url:a.UpdateInfo,method:"post",headers:{"Content-Type":"application/json"},data:e})}function s(e){return Object(i["a"])({url:a.GetByDeviceId,method:"get",params:e})}function u(e){return Object(i["a"])({url:a.UpdateInfoDevice,method:"post",headers:{"Content-Type":"application/json"},data:e})}function p(e){return Object(i["a"])({url:a.createDevice,method:"post",headers:{"Content-Type":"application/json"},data:e})}function f(e){return Object(i["a"])({url:a.deleteDevice,method:"post",headers:{"Content-Type":"application/json"},data:e})}function m(e){return Object(i["a"])({url:a.BatchAdd,method:"post",headers:{"Content-Type":"application/json"},data:e})}},c630:function(e,t,n){"use strict";var i=n("105e"),a=n.n(i);a.a}}]);
//# sourceMappingURL=chunk-57a38824.e2948eb0.js.map